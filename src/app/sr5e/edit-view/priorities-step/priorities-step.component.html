<div class="row my-3">

    <div class="col-3 d-flex align-items-end">
        <div>
            <h5 class="mb-0 ms-4">Priorities</h5>
        </div>
    </div>

    <div class="col-9">
        <form class="row g-3" [formGroup]="priorityForm">

            <div class="col-2 text-center">
                <label class="form-label" for="metatype">Meta Type</label>
                <select class="form-select form-select-sm mx-auto text-center" formControlName="metaType">
                    <option *ngFor="let priority of availablePriorityOptions" [ngValue]="priority">
                        {{ priority | titlecase }}
                    </option>
                </select>
            </div>

            <div class="col-2 text-center">
                <label class="form-label" for="attributes">Attributes</label>
                <select class="form-select form-select-sm mx-auto text-center" formControlName="attributes">
                    <option *ngFor="let priority of availablePriorityOptions" [ngValue]="priority">
                        {{ priority | titlecase }}
                    </option>
                </select>
            </div>

            <div class="col-2 text-center">
                <label class="form-label text-nowrap" for="magicResonance">Magic / Resonance</label>
                <select class="form-select form-select-sm mx-auto text-center" formControlName="magic">
                    <option *ngFor="let priority of availablePriorityOptions" [ngValue]="priority">
                        {{ priority | titlecase }}
                    </option>
                </select>
            </div>
            
            <div class="col-2 text-center">
                <label class="form-label" for="skills">Skills</label>
                <select class="form-select form-select-sm mx-auto text-center" formControlName="skills">
                    <option *ngFor="let priority of availablePriorityOptions" [ngValue]="priority">
                        {{ priority | titlecase }}
                    </option>
                </select>
            </div>

            <div class="col-2 text-center">
                <label class="form-label" for="resources">Resources</label>
                <select class="form-select form-select-sm mx-auto text-center" formControlName="resources">
                    <option *ngFor="let priority of availablePriorityOptions" [ngValue]="priority">
                        {{ priority | titlecase }}
                    </option>
                </select>
            </div>

            <div class="row text-center mt-2" *ngIf="!isFormValid">
                <div class="col">
                    <p class="text-warning m-0">Under normal circumstances, you may only set a priority level once.</p>
                </div>
            </div>

        </form>
    </div>
</div>

<div class="row">

    <div class="col-12">
        <div class="card shadow">
            <div class="table-responsive">

                <table class="table table-striped">

                    <thead>
                        <tr class="text-center bg-primary">
                            <th colspan="6">
                                <h5 class="m-0">Priority Table</h5>
                            </th>
                        </tr>
                        <tr class="text-center">
                            <th class="col-1" scope="col">Priority</th>
                            <th class="col-2" scope="col">Meta Type</th>
                            <th class="col-1" scope="col">Attributes</th>
                            <th class="col-3" scope="col">Magic or Resonance</th>
                            <th class="col-1" scope="col">Skills</th>
                            <th class="col-1" scope="col">Resources</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let priority of availablePriorityOptions">
                            <td class="text-center">
                                {{ priority | titlecase }}
                            </td>

                            <td class="text-center" [ngClass]="{ 'text-info': this.character.priorities.metaType === priority }">
                                <ul class="list-unstyled">
                                    <li *ngFor="let metaType of getPriorityMetaTypesFromTable(priority)">
                                        {{ metaType.name | titlecase }} ({{ metaType.specialAttrPoints }})
                                    </li>
                                </ul>
                            </td>

                            <td class="text-center" [ngClass]="{ 'text-info': this.character.priorities.attributes === priority }">
                                {{ getPriorityAttributePointsFromTable(priority) }}
                            </td>

                            <td [ngClass]="{ 'text-info': this.character.priorities.magic === priority }">
                                <ul class="list-unstyled">
                                    <li *ngFor="let text of getPriorityMagicTextFromTable(priority)">
                                        <strong class="text-secondary">{{ text.title }}: </strong>{{ text.description }}
                                    </li>
                                </ul>
                            </td>
                            <td class="text-center" [ngClass]="{ 'text-info': this.character.priorities.skills === priority }">
                                {{ getPrioritySkillsPointsFromTable(priority).skillPoints }}/{{ getPrioritySkillsPointsFromTable(priority).skillGroupPoints }}
                            </td>
                            <td class="text-center" [ngClass]="{ 'text-info': this.character.priorities.resources === priority }">
                                {{ getResourceAmountByLevelOfPlayFromTable(priority) }} &#165;
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>